- macro: user_known_core_pattern_modifiers
  condition: (never_true)

- rule: Core Pattern Escape Attempt
  desc: >
    Detects modification of /proc/sys/kernel/core_pattern to use a pipe, potentially to escape containers or execute arbitrary commands via core dumps.
  condition: >
    open_write and fd.name="/proc/sys/kernel/core_pattern" and
    evt.buffer contains "|" and
    not user_known_core_pattern_modifiers
  output: >
    Core pattern modification to pipe detected | file=%fd.name user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty evt_type=%evt.type
  priority: CRITICAL
  tags: [process, container, escape, mitre_escape, T1611]
  source: syscall
